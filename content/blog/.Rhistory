# add a variable for when men are more successful than women (for colours)
mutate(men_more_successful = success_rates_men > success_rates_women) %>%
ggplot() +
# add a line segment that goes from men to women for each discipline
geom_segment(aes(x = 1, xend = 2,
y = success_rates_men,
yend = success_rates_women,
group = discipline,
col = men_more_successful),
size = 1.2) +
# set the colors
scale_color_manual(values = c("#468189", "#9DBEBB"), guide = "none")  +
# remove all axis stuff
theme_classic() +
theme(axis.line = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
gg_slope
gg_slope <- gg_slope +
# add vertical lines that act as axis for men
geom_segment(x = 1, xend = 1,
y = min(research_funding_rates$success_rates_men) - 2,
yend = max(research_funding_rates$success_rates_men) + 1,
col = "grey70", size = 0.5) +
# add vertical lines that act as axis for women
geom_segment(x = 2, xend = 2,
y = min(research_funding_rates$success_rates_men) - 2,
yend = max(research_funding_rates$success_rates_men) + 1,
col = "grey70", size = 0.5) +
# add the words "men" and "women" above their axes
geom_text(aes(x = x, y = y, label = label),
data = data.frame(x = 1:2,
y = 2 + max(research_funding_rates$success_rates_men),
label = c("men", "women")),
col = "grey30",
size = 6)
gg_slope
ggslope <- ggslope +
# add the label and success rate for each discipline next the men axis
geom_text(aes(x = 1 - 0.03,
y = success_rates_men,
label = paste0(discipline, ", ", round(success_rates_men, 1), "%")),
col = "grey30", hjust = "right") +
# add the success rate next to each point on the women axis
geom_text(aes(x = 2 + 0.08,
y = success_rates_women,
label = paste0(round(success_rates_women, 1), "%")),
col = "grey30") +
# add the white outline for the points at each rate for men
geom_point(aes(x = 1,
y = success_rates_men), size = 4.5,
col = "white") +
# add the white outline for the points at each rate for women
geom_point(aes(x = 2,
y = success_rates_women), size = 4.5,
col = "white") +
# add the actual points at each rate for men
geom_point(aes(x = 1,
y = success_rates_men), size = 4,
col = "grey60") +
# add the actual points at each rate for men
geom_point(aes(x = 2,
y = success_rates_women), size = 4,
col = "grey60") +
# set the limits of the x-axis
scale_x_continuous(limits = c(0.5, 2.1))
gg_slope
gg_slope <- gg_slope +
# add the label and success rate for each discipline next the men axis
geom_text(aes(x = 1 - 0.03,
y = success_rates_men,
label = paste0(discipline, ", ", round(success_rates_men, 1), "%")),
col = "grey30", hjust = "right") +
# add the success rate next to each point on the women axis
geom_text(aes(x = 2 + 0.08,
y = success_rates_women,
label = paste0(round(success_rates_women, 1), "%")),
col = "grey30") +
# add the white outline for the points at each rate for men
geom_point(aes(x = 1,
y = success_rates_men), size = 4.5,
col = "white") +
# add the white outline for the points at each rate for women
geom_point(aes(x = 2,
y = success_rates_women), size = 4.5,
col = "white") +
# add the actual points at each rate for men
geom_point(aes(x = 1,
y = success_rates_men), size = 4,
col = "grey60") +
# add the actual points at each rate for men
geom_point(aes(x = 2,
y = success_rates_women), size = 4,
col = "grey60") +
# set the limits of the x-axis
scale_x_continuous(limits = c(0.5, 2.1))
gg_slope <- gg_slope +
# add the label and success rate for each discipline next the men axis
geom_text(aes(x = 1 - 0.03,
y = success_rates_men,
label = paste0(discipline, ", ",
round(success_rates_men, 1), "%")),
col = "grey30", hjust = "right") +
# add the success rate next to each point on the women axis
geom_text(aes(x = 2 + 0.08,
y = success_rates_women,
label = paste0(round(success_rates_women, 1), "%")),
col = "grey30") +
# set the limits of the x-axis so that the labels are not cut off
scale_x_continuous(limits = c(0.5, 2.1))
gg_slope
gg_slope <- research_funding_rates %>%
# add a variable for when men are more successful than women (for colours)
mutate(men_more_successful = success_rates_men > success_rates_women) %>%
ggplot() +
# add a line segment that goes from men to women for each discipline
geom_segment(aes(x = 1, xend = 2,
y = success_rates_men,
yend = success_rates_women,
group = discipline,
col = men_more_successful),
size = 1.2) +
# set the colors
scale_color_manual(values = c("#468189", "#9DBEBB"), guide = "none")  +
# remove all axis stuff
theme_classic() +
theme(axis.line = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
gg_slope
gg_slope <- gg_slope +
# add vertical lines that act as axis for men
geom_segment(x = 1, xend = 1,
y = min(research_funding_rates$success_rates_men) - 2,
yend = max(research_funding_rates$success_rates_men) + 1,
col = "grey70", size = 0.5) +
# add vertical lines that act as axis for women
geom_segment(x = 2, xend = 2,
y = min(research_funding_rates$success_rates_men) - 2,
yend = max(research_funding_rates$success_rates_men) + 1,
col = "grey70", size = 0.5) +
# add the words "men" and "women" above their axes
geom_text(aes(x = x, y = y, label = label),
data = data.frame(x = 1:2,
y = 2 + max(research_funding_rates$success_rates_men),
label = c("men", "women")),
col = "grey30",
size = 6)
gg_slope
gg_slope <- gg_slope +
# add the label and success rate for each discipline next the men axis
geom_text(aes(x = 1 - 0.03,
y = success_rates_men,
label = paste0(discipline, ", ",
round(success_rates_men, 1), "%")),
col = "grey30", hjust = "right") +
# add the success rate next to each point on the women axis
geom_text(aes(x = 2 + 0.08,
y = success_rates_women,
label = paste0(round(success_rates_women, 1), "%")),
col = "grey30") +
# set the limits of the x-axis so that the labels are not cut off
scale_x_continuous(limits = c(0.5, 2.1))
gg_slope
gg_dot <- research_funding_rates %>%
# rearrange the factor levels for discipline by rates for women
arrange(success_rates_women) %>%
mutate(discipline = fct_inorder(discipline)) %>%
ggplot() +
# add a dummy point for scaling purposes
geom_point(aes(x = 12, y = discipline),
size = 0, col = "white") +
# add the horizontal grid lines
geom_hline(yintercept = 1:9, col = "grey80") +
# add a point for each male success rate
geom_point(aes(x = success_rates_men, y = discipline),
size = 11, col = "#9DBEBB")
gg_dot
gg_dot <- research_funding_rates %>%
# rearrange the factor levels for discipline by rates for women
arrange(success_rates_women) %>%
mutate(discipline = fct_inorder(discipline)) %>%
ggplot() +
# add a dummy point for scaling purposes
geom_point(aes(x = 12, y = discipline),
size = 0, col = "white") +
# add the horizontal grid lines
geom_hline(yintercept = 1:9, col = "grey80") +
# add a point for each male success rate
geom_point(aes(x = success_rates_men, y = discipline),
size = 11, col = "#9DBEBB") +
# add the border for each point for female success rate
geom_point(aes(x = success_rates_women, y = discipline),
size = 11.5, col = "white") +
# add a point for each female success rate
geom_point(aes(x = success_rates_women, y = discipline),
size = 11, col = "#468189")
gg_dot
gg_dot <- research_funding_rates %>%
# rearrange the factor levels for discipline by rates for women
arrange(success_rates_women) %>%
mutate(discipline = fct_inorder(discipline)) %>%
ggplot() +
# remove axes
theme(axis.title = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank()) +
# universally increase size of text and remove grey theme
theme_classic(base_size = 14) +
# add a dummy point for scaling purposes
geom_point(aes(x = 12, y = discipline),
size = 0, col = "white") +
# add the horizontal discipline lines
geom_hline(yintercept = 1:9, col = "grey80") +
# add a point for each male success rate
geom_point(aes(x = success_rates_men, y = discipline),
size = 11, col = "#9DBEBB") +
# add the border for each point for female success rate
geom_point(aes(x = success_rates_women, y = discipline),
size = 11.5, col = "white") +
# add a point for each female success rate
geom_point(aes(x = success_rates_women, y = discipline),
size = 11, col = "#468189")
gg_dot
gg_dot <- research_funding_rates %>%
# rearrange the factor levels for discipline by rates for women
arrange(success_rates_women) %>%
mutate(discipline = fct_inorder(discipline)) %>%
ggplot() +
# remove axes and superfluous grids
theme(axis.title = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank()) +
theme_classic(base_size = 14) +
# add a dummy point for scaling purposes
geom_point(aes(x = 12, y = discipline),
size = 0, col = "white") +
# add the horizontal discipline lines
geom_hline(yintercept = 1:9, col = "grey80") +
# add a point for each male success rate
geom_point(aes(x = success_rates_men, y = discipline),
size = 11, col = "#9DBEBB") +
# add the border for each point for female success rate
geom_point(aes(x = success_rates_women, y = discipline),
size = 11.5, col = "white") +
# add a point for each female success rate
geom_point(aes(x = success_rates_women, y = discipline),
size = 11, col = "#468189")
gg_dot
gg_dot <- gg_dot +
# add the text (%) for each male success rate
geom_text(aes(x = success_rates_men, y = discipline,
label = paste0(round(success_rates_men, 1))),
col = "black") +
# add the text (%) for each female success rate
geom_text(aes(x = success_rates_women, y = discipline,
label = paste0(round(success_rates_women, 1))),
col = "white") +
# add a label above the first two points
geom_text(aes(x = x, y = y, label = label, col = label),
data.frame(x = c(25.6 - 1.1, 26.5 + 0.6), y = 10,
label = c("women", "men")), size = 6) +
scale_color_manual(values = c("#9DBEBB", "#468189"), guide = "none") +
# manually specify the x-axis
scale_x_continuous(breaks = c(15, 20, 25),
labels = c("15%", "20%", "25%"))
gg_dot
gg_dot <- research_funding_rates %>%
# rearrange the factor levels for discipline by rates for women
arrange(success_rates_women) %>%
mutate(discipline = fct_inorder(discipline)) %>%
ggplot() +
# remove axes and superfluous grids
theme(axis.title = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank()) +
theme_classic(base_size = 14) +
# add a dummy point for scaling purposes
geom_point(aes(x = 12, y = discipline),
size = 0, col = "white") +
# add the horizontal discipline lines
geom_hline(yintercept = 1:9, col = "grey80") +
# add a point for each male success rate
geom_point(aes(x = success_rates_men, y = discipline),
size = 11, col = "#9DBEBB") +
# add the border for each point for female success rate
geom_point(aes(x = success_rates_women, y = discipline),
size = 11.5, col = "white") +
# add a point for each female success rate
geom_point(aes(x = success_rates_women, y = discipline),
size = 11, col = "#468189")
gg_dot
gg_dot <- gg_dot +
# add the text (%) for each male success rate
geom_text(aes(x = success_rates_men, y = discipline,
label = paste0(round(success_rates_men, 1))),
col = "black") +
# add the text (%) for each female success rate
geom_text(aes(x = success_rates_women, y = discipline,
label = paste0(round(success_rates_women, 1))),
col = "white") +
# add a label above the first two points
geom_text(aes(x = x, y = y, label = label, col = label),
data.frame(x = c(25.6 - 1.1, 26.5 + 0.6), y = 10,
label = c("women", "men")), size = 6) +
scale_color_manual(values = c("#9DBEBB", "#468189"), guide = "none") +
# manually specify the x-axis
scale_x_continuous(breaks = c(15, 20, 25),
labels = c("15%", "20%", "25%"))
gg_dot
gg_dot <- research_funding_rates %>%
# rearrange the factor levels for discipline by rates for women
arrange(success_rates_women) %>%
mutate(discipline = fct_inorder(discipline)) %>%
ggplot() +
# remove axes and superfluous grids
theme(axis.title = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank()) +
theme_classic(base_size = 14) +
# add a dummy point for scaling purposes
geom_point(aes(x = 12, y = discipline),
size = 0, col = "white") +
# add the horizontal discipline lines
geom_hline(yintercept = 1:9, col = "grey80") +
# add a point for each male success rate
geom_point(aes(x = success_rates_men, y = discipline),
size = 11, col = "#9DBEBB") +
# add the border for each point for female success rate
geom_point(aes(x = success_rates_women, y = discipline),
size = 11.5, col = "white") +
# add a point for each female success rate
geom_point(aes(x = success_rates_women, y = discipline),
size = 11, col = "#468189")
gg_dot
gg_dot <- research_funding_rates %>%
# rearrange the factor levels for discipline by rates for women
arrange(success_rates_women) %>%
mutate(discipline = fct_inorder(discipline)) %>%
ggplot() +
# remove axes and superfluous grids
theme_classic() +
theme(axis.title = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank()) +
# add a dummy point for scaling purposes
geom_point(aes(x = 12, y = discipline),
size = 0, col = "white") +
# add the horizontal discipline lines
geom_hline(yintercept = 1:9, col = "grey80") +
# add a point for each male success rate
geom_point(aes(x = success_rates_men, y = discipline),
size = 11, col = "#9DBEBB") +
# add the border for each point for female success rate
geom_point(aes(x = success_rates_women, y = discipline),
size = 11.5, col = "white") +
# add a point for each female success rate
geom_point(aes(x = success_rates_women, y = discipline),
size = 11, col = "#468189")
gg_dot
?serve_site
stop_server()
library(blogdown)
stop_server()
serve_site()
# make grouped bar plot
ggplot(success_rates) +
# add bar for each discipline colored by gender
geom_bar(aes(x = discipline, y = success, fill = gender),
stat = "identity", position = "dodge") +
# name axes and remove gap between bars and y-axis
scale_y_continuous("Success Rate", expand = c(0, 0)) +
scale_x_discrete("Discipline") +
scale_color_manual(values = c("#468189", "#9DBEBB")) +
# remove grey theme
theme_classic(base_size = 18) +
# rotate x-axis and remove superfluous axis elements
theme(axis.text.x = element_text(angle = 90,
hjust = 1, vjust = 0),
axis.line = element_blank(),
axis.ticks.x = element_blank())
stop_server()
# load in libraries
library(tidyverse)
library(dslabs)
library(knitr)
# combine male and female success rates into single data frame
success_rates <- rbind(
# male success rates
transmute(research_funding_rates,
discipline,
success = success_rates_men,
gender = "Male"),
# female success rates
transmute(research_funding_rates,
discipline,
success = success_rates_women,
gender = "Female")) %>%
# reorder gender factor levels
mutate(gender = fct_inorder(gender))
# make grouped bar plot
ggplot(success_rates) +
# add bar for each discipline colored by gender
geom_bar(aes(x = discipline, y = success, fill = gender),
stat = "identity", position = "dodge") +
# name axes and remove gap between bars and y-axis
scale_y_continuous("Success Rate", expand = c(0, 0)) +
scale_x_discrete("Discipline") +
scale_color_manual(values = c("#468189", "#9DBEBB")) +
# remove grey theme
theme_classic(base_size = 18) +
# rotate x-axis and remove superfluous axis elements
theme(axis.text.x = element_text(angle = 90,
hjust = 1, vjust = 0),
axis.line = element_blank(),
axis.ticks.x = element_blank())
# make grouped bar plot
ggplot(success_rates) +
# add bar for each discipline colored by gender
geom_bar(aes(x = discipline, y = success, fill = gender),
stat = "identity", position = "dodge") +
# name axes and remove gap between bars and y-axis
scale_y_continuous("Success Rate", expand = c(0, 0)) +
scale_x_discrete("Discipline") +
scale_fill_manual(values = c("#468189", "#9DBEBB")) +
# remove grey theme
theme_classic(base_size = 18) +
# rotate x-axis and remove superfluous axis elements
theme(axis.text.x = element_text(angle = 90,
hjust = 1, vjust = 0),
axis.line = element_blank(),
axis.ticks.x = element_blank())
# combine male and female success rates into single data frame
success_rates <- rbind(
# male success rates
transmute(research_funding_rates,
discipline,
success = success_rates_men,
gender = "Male"),
# female success rates
transmute(research_funding_rates,
discipline,
success = success_rates_women,
gender = "Female"))
# make grouped bar plot
ggplot(success_rates) +
# add bar for each discipline colored by gender
geom_bar(aes(x = discipline, y = success, fill = gender),
stat = "identity", position = "dodge") +
# name axes and remove gap between bars and y-axis
scale_y_continuous("Success Rate", expand = c(0, 0)) +
scale_x_discrete("Discipline") +
scale_fill_manual(values = c("#468189", "#9DBEBB")) +
# remove grey theme
theme_classic(base_size = 18) +
# rotate x-axis and remove superfluous axis elements
theme(axis.text.x = element_text(angle = 90,
hjust = 1, vjust = 0),
axis.line = element_blank(),
axis.ticks.x = element_blank())
# combine male and female success rates into single data frame
success_rates <- rbind(
# male success rates
transmute(research_funding_rates,
discipline,
success = success_rates_men,
gender = "Male"),
# female success rates
transmute(research_funding_rates,
discipline,
success = success_rates_women,
gender = "Female"))
# make grouped bar plot
ggplot(success_rates) +
# add bar for each discipline colored by gender
geom_bar(aes(x = discipline, y = success, fill = gender),
stat = "identity", position = "dodge") +
# name axes and remove gap between bars and y-axis
scale_y_continuous("Success Rate", expand = c(0, 0)) +
scale_x_discrete("Discipline") +
scale_fill_manual(values = values = c("#468189", "#9DBEBB")) +
# remove grey theme
theme_classic(base_size = 18) +
# rotate x-axis and remove superfluous axis elements
theme(axis.text.x = element_text(angle = 90,
hjust = 1, vjust = 0),
axis.line = element_blank(),
axis.ticks.x = element_blank())
# make grouped bar plot
ggplot(success_rates) +
# add bar for each discipline colored by gender
geom_bar(aes(x = discipline, y = success, fill = gender),
stat = "identity", position = "dodge") +
# name axes and remove gap between bars and y-axis
scale_y_continuous("Success Rate", expand = c(0, 0)) +
scale_x_discrete("Discipline") +
scale_fill_manual(values = c("#468189", "#9DBEBB")) +
# remove grey theme
theme_classic(base_size = 18) +
# rotate x-axis and remove superfluous axis elements
theme(axis.text.x = element_text(angle = 90,
hjust = 1, vjust = 0),
axis.line = element_blank(),
axis.ticks.x = element_blank())
serve_site()
stop_server()
serve_site()
stop_server()
serve_site()
stop_server()
